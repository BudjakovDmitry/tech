# Netplan configuration

Netplan configuration is stored in YAML-formatted files in the `/etc/netplan` directory.

Without configuration, Netplan will not do anything. The simplest configuration snippet
(to bring up things via DHCP on workstations) is as follows:

```yaml
network:
  version: 2
  renderer: NetworkManager
```

This will make netplan hand over control to NetworkManager, which will manage all
devices in its default way (i.e. any ethernet device will come up with DHCP once carrier
is detected).

When individual interface configuration are given, it will not let devices automatically
come up using DHCP, but interface needs to be specific in a file in `/etc/netplan/` with
its explicit YAML settings for the network or NetworkManager backend renderers.

Provided your system was initialised using `cloud-init`, such as the Ubuntu virtual
machine you can find the initial Netplan configuration in the `50-cloud-init.yaml` file.

You should see an output similar to this:

```yaml
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        enp1s0:
            dhcp4: true
    version: 2
```

This configuration file is automatically generated by the `cloud-init` tool when the
system is initialised. As noted in the file comments, direct changes to this file do not
persist.

## Creating and modifying Netplan configuration

There are two methods to create or modify Netplan configuration:

- Using the `netplan set` command.
- Editing the YAML configuration files manually.

## Applying new Netplan configuration

New or modified Netplan settings need to be applied before they take effect on a running
system.

> __Note__: using the `netplan set` command to modify  configuration or editing
> (creating) the Netplan YAML configuration files directly does not automatically apply
> the new settings to the running system.

After creating a new configuration, follow these steps to apply the settings and confirm
they have taken effect.

1. Test the new configuration (optional):

```shell
netplan try
```

Applies the new configuration temporarily (120 seconds by default) and waits for
confirmation (within the specified time) to make it permanent.

2. Apply the Netplan configuration:

```shell
netplan apply
```
